import{S as r,_ as U,s as V,A as R}from"./Loader.3da1754d.js";import{r as j,a as E,s as D}from"./head.ed8b6b52.js";import{U as k,R as N,a as M}from"./index.cea868e5.js";import{d as q,l as p,E as C,G,y as I,H as z,m as K,n as P,r as W,o as l,b as h,e,u as d,h as x,w as u,t as g,F as J,g as O,f as Q,C as X,i as Y}from"./vendor.569ec125.js";import{M as L}from"./Message.5fbf4e15.js";const Z=e("hr",null,null,-1),ee={class:"u-container u-container-h"},te={key:0,class:"u-flex py-10 min-h-[50vh]"},oe={key:1},ne=e("p",null,"404",-1),se=e("p",null," I know you could read, but this isn't the place for it. ",-1),ae=Y("\u{1F449} Go to articles"),le=e("p",null,"500",-1),ce=e("p",null,"Unfortunately, couldn't fetch the article.",-1),ie={key:1},re={class:"mb-3"},de={class:"text-3xl font-bold mb-1"},ue={class:"mb-1"},me={class:"text-sm mb-1 text-secondary-400 mb-1"},he={class:"text-xs"},ge={class:"text-primary-500"},ve={class:"text-secondary-400"},_e=e("hr",null,null,-1),pe={class:"lg:grid lg:grid-cols-4 lg:gap-12"},fe={class:"mt-8 lg:col-span-1"},ye={class:"lg:sticky lg:top-6"},be=e("p",{class:"text-lg font-bold mb-2"}," Table of contents ",-1),ke={class:"lg:max-h-[85vh] lg:overflow-y-auto"},xe=["onClick"],Ae=["innerHTML"],Ie=q({setup(we){const c=p("Loading..."),f=C([]),A=[],v=G(),m=p(r.processing),n=p(null),S=I(()=>m.value===r.failed&&c.value==="404"),w=async()=>{c.value="Loading...";const t=typeof v.params.slug=="string"?v.params.slug:Array.isArray(v.params.slug)&&v.params.slug.length===1?v.params.slug[0]:null;if(!t){m.value=r.failed,c.value="404";return}try{n.value=await R.getArticleFromSlug(t),c.value=n.value.meta.title;const a=[{name:"title",content:n.value.meta.title},{name:"og:title",content:n.value.meta.title},{name:"description",content:n.value.meta.description},{name:"og:description",content:n.value.meta.description},{name:"og:type",content:"article"},{name:"keywords",content:n.value.meta.tags.join(", ")}];a.forEach(s=>{const o=document.querySelector(`meta[name="${s.name}"]`);o!=null&&o.content&&A.push({name:s.name,content:o.content})}),f.push(...a),m.value=r.done}catch{m.value=r.failed,c.value="500"}},y=C([]),$=I(()=>{var a;if(y.splice(0,1/0),!n.value)return"";const t=document.createElement("div");t.id=`ac-${k.random(8).join("")}`,t.innerHTML=k.getSafeHtml((a=n.value)==null?void 0:a.content);for(const s of Array.from(t.querySelectorAll(":is(h1, h2, h3, h4, h5, h6)"))){const o=s.textContent,i=`h-${k.getHtmlSafeId(o)}`;s.id=i,s.setAttribute("onclick","window.toggleActiveHeading(this.id);"),y.push({id:i,title:o})}return B(t.id),t.outerHTML}),_=p(null),b=(t,a="internal")=>{const s="data-active";if(_.value){const i=document.getElementById(_.value);if(i==null||i.removeAttribute(s),a==="internal"&&_.value===t){_.value=null;return}}const o=document.getElementById(t);o&&(history.replaceState(void 0,"",`#${t}`),o.setAttribute(s,""),o.scrollIntoView({behavior:"smooth"}),_.value=t)};window.toggleActiveHeading=b;const B=t=>{const a=setInterval(()=>{document.getElementById(t)&&(b(location.hash.slice(1)),clearInterval(a))},100)},F=z([c,f],()=>{D(M.getTitle(`${c.value} ${M.infix} Article`)),E(f)}),H=p(null),T=()=>{const t=document.scrollingElement;if(t)for(const a of y){const s=document.getElementById(a.id);if(t.scrollTop<s.offsetTop)break;H.value=s.id}};return K(()=>{w(),document.addEventListener("scroll",T)}),P(()=>{F(),delete window.toggleActiveHeading,document.removeEventListener("scroll",T),j(f),E(A)}),(t,a)=>{const s=W("router-link");return l(),h("div",null,[Z,e("div",ee,[m.value!==d(r).done||!n.value?(l(),h("div",te,[m.value===d(r).processing?(l(),x(U,{key:0})):(l(),h("div",oe,[d(S)?(l(),x(L,{key:0},{header:u(()=>[ne]),body:u(()=>[se]),footer:u(()=>[Q(s,{class:"text-primary-500 hover:text-secondary-500",to:d(N).articles},{default:u(()=>[ae]),_:1},8,["to"])]),_:1})):(l(),x(L,{key:1},{header:u(()=>[le]),body:u(()=>[ce]),footer:u(()=>[e("button",{class:"text-primary-500 hover:text-secondary-500",onClick:w}," \u{1F504} Retry ")]),_:1}))]))])):(l(),h("article",ie,[e("div",re,[e("p",de,g(n.value.meta.title),1),e("p",ue,g(n.value.meta.description),1),e("p",me,g(n.value.meta.tags.map(o=>`#${o}`).join(" ")),1),e("p",he,[e("span",ge,g(d(V).Date.relative(new Date(n.value.meta.publishedAt))),1),e("span",ve," / "+g(n.value.meta.readingTime)+" mins. read",1)])]),_e,e("div",pe,[e("aside",fe,[e("div",ye,[be,e("ul",ke,[(l(!0),h(J,null,O(d(y),o=>(l(),h("li",{key:o.id,class:X(["cursor-pointer pl-4 py-1 hover:bg-secondary-900 border-l-2 border-secondary-700",H.value===o.id&&"lg:bg-primary-500/10 lg:border-primary-500 lg:text-primary-500"]),onClick:i=>b(o.id,"external")},g(o.title),11,xe))),128))])])]),e("div",{class:"u-stylify lg:row-start-1 lg:col-start-1 lg:col-span-3",id:"content",innerHTML:d($)},null,8,Ae)])]))])])}}});export{Ie as default};
